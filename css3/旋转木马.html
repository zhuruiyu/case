<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        #state{
            background: #999;
            width: 1100px;
            height: 500px;
            box-shadow: 10px 10px rgba(0, 0, 0, .6);
            margin: 50px auto;
            position: relative;
            -webkit-perspective: 800px;
            -webkit-perspective-origin: 50% -10%;
            -webkit-transition: transform 1s ease-in-out ;
        }
        #container{
           width: 160px;
            height: 125px;
            top:120px;
            position: absolute;
            left: 50%;
            margin-left: -64px;
            -webkit-transform-style:  preserve-3d;
            -webkit-transition: transform 1s ease-in-out ;
        }
        #container img{
            width: 160px;
            height: 125px;
            position: absolute;
            -webkit-transition: transform 1s ease-in-out ;
        }

    </style>
</head>
<body>

<div id="state">
    <div id="container">
        <!--<img src="image/001.jpg" alt=""/>-->
        <!--<img src="image/002.jpg" alt=""/>-->
        <!--<img src="image/003.jpg" alt=""/>-->
        <!--<img src="image/004.jpg" alt=""/>-->
        <!--<img src="image/005.jpg" alt=""/>-->
        <!--<img src="image/006.jpg" alt=""/>-->
        <!--<img src="image/007.jpg" alt=""/>-->
        <!--<img src="image/008.JPG" alt=""/>-->
        <!--<img src="image/009.JPG" alt=""/>-->
    </div>
</div>

<script>
    var oContainer = document.getElementById('container');

//    for(var i=0;i<aImg.length;i++){
//        aImg[i].style.webkitTransition = (9-i)*100+'ms';
//        aImg[i].style.WebkitTransform = 'rotateY('+-i*40+'deg) translateZ('+(translateDis+20)+'px';
//
//    }

    //立执行  立即函数
    //闭包函数：
    //图片加载完成之后执行



//    for(var i=0;i<aImg.length;i++){
//        (function(index){
//                setTimeout(function(){
//                    aImg[index].style.WebkitTransform = 'rotateY('+-index*40+'deg) translateZ('+(translateDis+20)+'px';
//                },(9-i)*100)
//        })(i);
//    }
    var aa=0;
    for(var i=0;i<9;i++){
        var oImg = new Image();

        oImg.onload = function () {
            aa++;
            if(aa == 9){
                for(var i=0;i<aImg.length;i++){
                    (function(index){
                        setTimeout(function(){
                            aImg[index].style.WebkitTransform = 'rotateY('+-index*40+'deg) translateZ('+(translateDis+20)+'px';
                        },(9-i)*100)
                    })(i);
                }
            }

        }
        oImg.src = 'img/'+(i+1)+'.jpg';
        oContainer.appendChild(oImg)
    }
    var aImg = oContainer.getElementsByTagName('img');
    var translateDis = oContainer.offsetWidth/2/Math.tan(20*Math.PI/180);





    //    var j = 8;
//    var timer=setInterval(function(){
//        if(j==0){
//            clearInterval(timer);
//        }
//       aImg[j].style.WebkitTransform = 'rotateY('+-j*40+'deg) translateZ('+(translateDis+20)+'px';
//       j--;
//    },100);


//    var idx = 0;
//    oContainer.onclick = function(){
//        idx++;
//        this.style.WebkitTransform = 'rotateY('+-40*idx+'deg)';
//        timer = setInterval(function(){
//            oContainer.onclick();
//        },1000);
//    }
</script>
</body>
</html>